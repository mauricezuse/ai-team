<div class="agents-container">
  <div class="agents-header">
    <h2>Agents</h2>
    <div class="agents-actions">
      <button pButton type="button" label="Refresh" icon="pi pi-refresh" (click)="loadAgents()" 
              [attr.data-testid]="'refresh-button'"></button>
      <button pButton type="button" label="Add Agent" icon="pi pi-plus" (click)="showAddDialog()"
              [attr.data-testid]="'add-agent-button'"></button>
    </div>
  </div>

  <div *ngIf="agents.length === 0" class="no-agents" [attr.data-testid]="'no-agents'">
    <p>No agents found</p>
  </div>

  <div *ngIf="agents.length > 0">
    <p-table [value]="agents" selectionMode="single" [(selection)]="selectedAgent" 
             (onRowSelect)="viewAgent($event)" [attr.data-testid]="'agents-table'">
      <ng-template pTemplate="header">
        <tr>
          <th>Name</th>
          <th>Role</th>
          <th>Goal</th>
          <th>Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-agent>
        <tr [attr.data-testid]="'agent-row'">
          <td>{{ agent.name }}</td>
          <td>{{ agent.role }}</td>
          <td>{{ agent.goal }}</td>
          <td>
            <button pButton type="button" icon="pi pi-eye" (click)="viewAgent(agent)"
                    [attr.data-testid]="'view-agent-button'" title="View Details"></button>
            <button pButton type="button" icon="pi pi-trash" class="p-button-danger" 
                    (click)="deleteAgent(agent)" [attr.data-testid]="'delete-agent-button'" 
                    title="Delete Agent"></button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<p-dialog header="Add Agent" [(visible)]="displayAddDialog" [modal]="true">
  <form (ngSubmit)="addAgent()">
    <div class="p-field">
      <label for="name">Name</label>
      <input id="name" type="text" pInputText [(ngModel)]="newAgent.name" name="name" required>
    </div>
    <div class="p-field">
      <label for="role">Role</label>
      <input id="role" type="text" pInputText [(ngModel)]="newAgent.role" name="role" required>
    </div>
    <div class="p-field">
      <label for="goal">Goal</label>
      <input id="goal" type="text" pInputText [(ngModel)]="newAgent.goal" name="goal" required>
    </div>
    <button pButton type="submit" label="Save"></button>
  </form>
</p-dialog>
